<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ»‘åŠ¨å˜è„¸å™¨ğŸ˜€</title>
<style>
body {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 0;
    margin: 0;
    width: 100vw;
    height: 100vh;
    font-family: 'Rubik', sans-serif;
}

.container {
    display: flex;
    flex-direction: column;
    overflow: hidden;
    width: 72em;
    max-width: 100%;
    min-width: 34em;
    height: 50em;
    max-height: 100%;
    min-height: 46em;
    background-color: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-radius: 1em;
    border: 1px solid #e0e0e0;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    font-size: 10px;
}

@media screen and (max-width: 480px) {
    .container {
        font-size: 5px;
    }
}

.container,
.container * {
    box-sizing: border-box;
}

.content {
    flex: 1;
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    position: relative;
    margin: 2em 4em;
    font-size: 100%;
}

.title {
    margin: 0;
    padding: 0;
    position: absolute;
    top: 5%;
    text-align: center;
    width: 100%;
    font-size: 2em;
}

.subtitle {
    margin: 0;
    padding: 0;
    position: absolute;
    top: 15%;
    text-align: center;
    width: 100%;
    font-size: 1.5em;
}

.button {
    color: #fff;
    border-radius: 1em;
    text-decoration: none;
    padding: 1em 2em;
    margin-bottom: 1em;
    text-align: center;
    font-size: 1.5em;
    transition: transform 0.2s ease, background-color 0.3s;
}

.button:hover {
    transform: scale(1.1); /* é¼ æ ‡æ‚¬åœæ—¶æ”¾å¤§ */
}

.button:active {
    transform: scale(0.9); /* é¼ æ ‡ç‚¹å‡»æ—¶ç¼©å° */
}

.button-happy {
    background-color: #6a4;
    border: none;
}

.button-happy:hover {
    background-color: #81c061;
}

.button-unhappy {
    background-color: #a43;
    border: none;
}

.button-unhappy:hover {
    background-color: #c85a48;
}

.face-slider {
    --happiness: 0.9;
    --derp: 1;
    --px: 0.5;
    --py: 0.5;
    width: 22em;
    max-width: 100%;
    height: 22em;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-image: radial-gradient(#f7e0b2, #eb5);
    border-radius: 100%;
    overflow: hidden;
    margin: 0;
    align-self: center;
    flex: 0 0 auto;
    border: solid 2px #ecb23e;
    box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.2);
}

.face-slider,
.face-slider * {
    position: absolute;
}

.face-slider::before {
    content: '';
    display: block;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    background-image: linear-gradient(to bottom, #5a8, rgba(85, 170, 136, 0));
    opacity: calc(1 - var(--happiness));
}

.face-slider-blush {
    width: 20%;
    height: 10%;
    background-color: rgba(255, 100, 100, 0.3);
    border: 3px solid rgba(255, 100, 100, 0.3);
    top: calc(45% + var(--py) * 10%);
    border-radius: 100%;
    opacity: calc(var(--happiness) * var(--happiness) * 0.9 + 0.1);
}

.face-slider-blush-left {
    left: calc(7% + var(--px) * 2%);
}

.face-slider-blush-right {
    right: calc(9% - var(--px) * 2%);
}

.face-slider-eye {
    width: calc(26% - var(--happiness) * 2%);
    height: calc(26% - var(--happiness) * 2%);
    background-color: #f6f6f6;
    border-radius: 100%;
    top: calc(25% + var(--py) * 10%);
    overflow: hidden;
}

.face-slider-eye-left {
    left: calc(18% + var(--px) * 4%);
}

.face-slider-eye-left::after {
    transform: translate(calc((var(--px) + var(--derp) * 0.5) * 100%), calc((var(--py) + var(--derp) * 0.5) * 100%));
}

.face-slider-eye-right {
    right: calc(22% - var(--px) * 4%);
}

.face-slider-eye-right::after {
    transform: translate(calc((var(--px) + var(--derp) * -0.3) * 100%), calc((var(--py) + var(--derp) * -0.3) * 100%));
}

.face-slider-eye::after {
    content: '';
    display: block;
    background-color: #421;
    width: calc(55% - var(--happiness) * 10%);
    height: calc(55% - var(--happiness) * 10%);
    border-radius: 100%;
}

.face-slider-mouth {
    width: calc(51% - var(--happiness) * 2%);
    height: calc(26% - var(--happiness) * 2%);
    background-color: #a33;
    border-radius: calc((1 - var(--happiness)) * 10em) calc((1 - var(--happiness)) * 10em) calc(var(--happiness) * 16em) calc(var(--happiness) * 16em);
    top: calc(57.5% + var(--py) * 5%);
    left: calc(47.5% + var(--px) * 5%);
    transform: translateX(-50%);
    overflow: hidden;
    border: 3px solid #962d2d;
}

.face-slider-mouth::before {
    content: '';
    display: block;
    position: absolute;
    width: 20%;
    height: 20%;
    top: 0;
    left: 50%;
    background-color: white;
    border-radius: 0 0 0.5em 0.5em;
}

.face-slider-mouth::after {
    content: '';
    display: block;
    position: absolute;
    width: 60%;
    height: 50%;
    left: 10%;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.2);
    border-radius: 20em 20em 0 0;
}

/* å¼¹çª—æ ·å¼ */
.popup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0);
  width: 30em;
  max-width: 90%;
  background-color: rgba(255, 255, 255, 0.9);
  border-radius: 1em;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
  z-index: 1000;
  opacity: 0;
  transition: transform 0.3s ease, opacity 0.3s ease;
}

.popup-content {
  padding: 2em;
  text-align: center;
}

.popup.show {
  transform: translate(-50%, -50%) scale(1);
  opacity: 1;
}

.popup h2 {
  margin-bottom: 1.5em;
  font-size: 1.5em;
}

.popup .button {
  margin: 0.5em;
}
</style>
</head>
<body>
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ»‘åŠ¨å˜è„¸å™¨ğŸ˜€</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>

<body>
  <!-- è¿™é‡Œå¯ä»¥ä¿®æ”¹æ–‡å­— -->
  <section class="container">
    <div class="content">
      <h1 class="title">æ±‚æ±‚ç»™æˆ‘ä¸‰å¹´éƒ½å·²ç»ä¸‹è½½äº†</h1>
      <h2 class="subtitle"></h2>
      <figure class="face-slider">
        <div class="face-slider-blush face-slider-blush-left"></div>
        <div class="face-slider-blush face-slider-blush-right"></div>
        <div class="face-slider-eye face-slider-eye-left"></div>
        <div class="face-slider-eye face-slider-eye-right"></div>
        <div class="face-slider-mouth"></div>
      </figure>
      <button class="button button-happy">3è¿å¥‰ä¸Š</button>
      <button class="button button-unhappy">ä¸‹æ¬¡ä¸€å®š</button>
    </div>
  </section>

  <!-- æ·»åŠ å¼¹çª—çš„ HTML -->
  <div class="popup" id="popup">
    <div class="popup-content">
      <h2>ä½ æ˜¯ä»å“ªé‡Œçœ‹åˆ°çš„ãƒ¾(â€¢Ï‰â€¢`)o</h2>
      <button class="button button-happy" id="btnBilibili">Bç«™ï¼ˆç›®å‰è¢«å°ç¦äº†å·²è€å®ï¼‰</button>
      <button class="button button-unhappy" id="btnDouyin">æŠ–éŸ³</button>
    </div>
  </div>
</body>

</html><script>
const container = document.querySelector('.container')
const face = document.querySelector('.face-slider')
const btnHappy = document.querySelector('.button-happy')
const btnUnhappy = document.querySelector('.button-unhappy')
const title = document.querySelector('.title')
const subtitle = document.querySelector('.subtitle')

const config = {
    // è¿™é‡Œä¿®æ”¹å¸è½½ç‚¹å‡»çš„æœ€å¤§æ¬¡æ•°,å¦‚æœä¸º0æˆ–1å°±æ˜¯ä¸ä¼šä¹±è·‘
    maxUnhappyCount: 2,
    // è¿™é‡Œä¿®æ”¹åŠ¨ç”»é€Ÿåº¦
    animationSpeed: 0.1,
    // è¿™é‡Œä¿®æ”¹æ–‡å­—ï¼Œæ­£å¸¸çŠ¶æ€ä¸‹åœ¨htmlæ–‡ä»¶é‡Œé¢ä¿®æ”¹
    states: {
        normal: {
            face: { happiness: 0.9, derp: 1, px: 0.5, py: 0.5 },
            ui: {
                btnHappyText: btnHappy.innerHTML,
                btnUnhappyText: btnUnhappy.innerHTML,
                titleText: title.innerHTML,
                subtitleText: subtitle.innerHTML
            }
        },
        happy: {
            face: { happiness: 1, derp: 0, px: 0.5, py: 0.5 },
            ui: {
                btnHappyText: 'è¿”å›',
                btnUnhappyText: 'è¿”å›',
                titleText: 'å·²å–æ¶ˆ',
                subtitleText: 'æ„Ÿè°¢æ‚¨ç»§ç»­ä½¿ç”¨æœ¬æ’ä»¶'
            }
        },
        unhappy: {
            face: { happiness: 0.2, derp: 0, px: 0.5, py: 0.5 },
            ui: {
                btnHappyText: 'è¿”å›',
                btnUnhappyText: 'è¿”å›',
                titleText: 'ä¸‹æ¬¡ä¸€å®šå°±ä¸‹æ¬¡ä¸€å®šã„Ÿ( â–”, â–” )ã„',
                subtitleText: ''
            }
        }
    }
}

const state = {
    rejectCount: 0,
    animationId: null,
    current: { ...config.states.normal.face },
    target: { ...config.states.normal.face }
}

function updateFaceCSS() {
    Object.entries(state.current).forEach(([prop, value]) => {
        face.style.setProperty(`--${prop}`, value)
    })
}

function transitionToState(stateType, hideButton = null) {
    const targetState = config.states[stateType];
    Object.assign(state.current, targetState.face);
    btnHappy.innerHTML = targetState.ui.btnHappyText;
    btnUnhappy.innerHTML = targetState.ui.btnUnhappyText;
    title.innerHTML = targetState.ui.titleText;
    subtitle.innerHTML = targetState.ui.subtitleText;

    if (hideButton) {
        hideButton.style.visibility = 'hidden';
        hideButton.style.transform = 'scale(1)'; // é‡ç½®ç¼©æ”¾æ•ˆæœ
        btnUnhappy.style.position = 'static';
        btnUnhappy.style.left = '';
        btnUnhappy.style.top = '';
    } else {
        btnHappy.style.visibility = 'visible';
        btnUnhappy.style.visibility = 'visible';
    }

    updateFaceCSS();
}

function stopAnimation() {
    if (state.animationId) {
        cancelAnimationFrame(state.animationId)
        state.animationId = null
    }
}

function startAnimation() {
    function updateFace() {
        for (const prop in state.target) {
            if (state.target[prop] === state.current[prop]) continue

            needsUpdate = true
            if (Math.abs(state.target[prop] - state.current[prop]) < 0.01) {
                state.current[prop] = state.target[prop]
            } else {
                state.current[prop] += (state.target[prop] - state.current[prop]) * config.animationSpeed
            }
        }
        updateFaceCSS()
        state.animationId = requestAnimationFrame(updateFace)
    }
    updateFace()
}

container.addEventListener('mousemove', ({ clientX: x, clientY: y }) => {
    const unhappyRect = btnUnhappy.getBoundingClientRect()
    const happyRect = btnHappy.getBoundingClientRect()
    const containerRect = container.getBoundingClientRect()

    const dx1 = x - (unhappyRect.x + unhappyRect.width * 0.5)
    const dy1 = y - (unhappyRect.y + unhappyRect.height * 0.5)
    const dx2 = x - (happyRect.x + happyRect.width * 0.5)
    const dy2 = y - (happyRect.y + happyRect.height * 0.5)

    const px = (x - containerRect.x) / containerRect.width
    const py = (y - containerRect.y) / containerRect.height

    const distUnhappy = Math.sqrt(dx1 * dx1 + dy1 * dy1)
    const distHappy = Math.sqrt(dx2 * dx2 + dy2 * dy2)
    const happiness = Math.pow(distUnhappy / (distHappy + distUnhappy), 0.75)

    state.target = { ...state.target, happiness, derp: 0, px, py }
})

container.addEventListener('mouseleave', () => {
    state.target = { ...config.states.normal.face }
})

btnHappy.addEventListener('click', () => {
    popup.classList.add('show'); // æ˜¾ç¤ºå¼¹çª—
});

btnUnhappy.addEventListener('click', () => {
    alert('ä¸‹æ¬¡ä¸€å®šï¼');
});

btnUnhappy.addEventListener('click', () => {
    if (state.animationId) {
        state.rejectCount++

        if (state.rejectCount >= config.maxUnhappyCount) {
            stopAnimation()
            transitionToState('unhappy', btnHappy)
        } else {
            btnUnhappy.style.position = 'absolute'
            btnUnhappy.style.left = `${Math.random() * 80}%`
            btnUnhappy.style.top = `${Math.random() * 80}%`
            state.target.happiness = Math.max(0.1, state.target.happiness - 0.1)
            btnHappy.style.transform = `scale(${1 + state.rejectCount * 0.1})`
        }
    } else {
        state.rejectCount = 0
        transitionToState('normal')
        startAnimation()
    }
})

// è·å–å¼¹çª—å’ŒæŒ‰é’®
const popup = document.getElementById('popup');
const btnBilibili = document.getElementById('btnBilibili');
const btnDouyin = document.getElementById('btnDouyin');

// Bç«™æŒ‰é’®ç‚¹å‡»äº‹ä»¶
btnBilibili.addEventListener('click', () => {
    window.location.href = 'https://space.bilibili.com/3546366343121193?spm_id_from=333.1007.0.0';
});

// æŠ–éŸ³æŒ‰é’®ç‚¹å‡»äº‹ä»¶
btnDouyin.addEventListener('click', () => {
    window.location.href = 'https://www.douyin.com/user/self?from_tab_name=main';
});

// ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­å¼¹çª—
window.addEventListener('click', (event) => {
    if (event.target === popup) {
        popup.classList.remove('show');
    }
});

startAnimation()
</script>
</body>
</html>
